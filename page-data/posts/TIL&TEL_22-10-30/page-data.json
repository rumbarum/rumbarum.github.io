{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/TIL&TEL_22-10-30/","result":{"data":{"markdownRemark":{"id":"a94e03c3-fac0-52ec-8761-03714bc34454","html":"<h2 id=\"til-today-i-learned\" style=\"position:relative;\"><a href=\"#til-today-i-learned\" aria-label=\"til today i learned permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TIL( Today I Learned)</h2>\n<h3 id=\"22-10-24-월\" style=\"position:relative;\"><a href=\"#22-10-24-%EC%9B%94\" aria-label=\"22 10 24 월 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-24 월</h3>\n<ul>\n<li>\n<p>WORKPLACE</p>\n<ul>\n<li>\n<p>PHASE 1 9-12 / 6</p>\n<ul>\n<li>\n<p>타임존 어웨어 네이브 차이</p>\n<ul>\n<li>둘간의 연산 미지원</li>\n<li>네이브 -> 어웨어 변환시 시간대별로 정책이 달라지는 부분이 있음</li>\n</ul>\n</li>\n<li>\n<p>타임값 적용기정리하기</p>\n<ul>\n<li>앞으로 tz aware 값을 사용하지 않을 것인가?</li>\n<li>서버의 타임 기준은 utc로 할 것인가? </li>\n</ul>\n</li>\n<li>\n<p>session scope uuid</p>\n<ul>\n<li>각 세션별 current scope 지정</li>\n<li>\n<p>contextVar</p>\n<ul>\n<li>상태가 있는 컨텍스트 관리자는 동시성 코드에서 상태가 예기치 않게 다른 코드로 유출되는 것을 방지하기 위해 <a href=\"https://docs.python.org/ko/3/library/threading.html#threading.local\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">threading.local()</a> 대신 컨텍스트 변수를 사용해야 합니다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>json_enabler</li>\n<li>aiohttp auth 인증 미들웨어</li>\n</ul>\n</li>\n<li>\n<p>PHASE 2 13-16 / 6</p>\n<ul>\n<li>Query Param Validation? pydantic?</li>\n</ul>\n</li>\n<li>PHASE 3 16-18 / 4</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-10-25-화\" style=\"position:relative;\"><a href=\"#22-10-25-%ED%99%94\" aria-label=\"22 10 25 화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-25 화</h3>\n<ul>\n<li>\n<p>WORKPLACE</p>\n<ul>\n<li>\n<p>PHASE 1 9-12 / 6</p>\n<ul>\n<li>\n<p>작업 개선 내역, README.md 업데이트</p>\n<ul>\n<li>샘플 코드</li>\n<li>코드 위치</li>\n</ul>\n</li>\n<li>\n<p>어제 작업한 내역 정리</p>\n<ul>\n<li>QueryBaseModel</li>\n<li>custom<em>json</em>enabler</li>\n</ul>\n</li>\n<li>예정 작업 정리</li>\n<li>aiohttp request</li>\n</ul>\n</li>\n<li>\n<p>PHASE 2 13-16 / 6</p>\n<ul>\n<li></li>\n</ul>\n</li>\n<li>\n<p>PHASE 3 16-18 / 4</p>\n<ul>\n<li>\n<p>fastapi response class 지저</p>\n<ul>\n<li>집에서 해보니까 잘됨…? ? ? ??? ? </li>\n<li>error</li>\n<li>정상동작</li>\n<li>올바른 타입 처리 방법은??</li>\n<li>현재 가능한 방법</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-10-26-수\" style=\"position:relative;\"><a href=\"#22-10-26-%EC%88%98\" aria-label=\"22 10 26 수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-26 수</h3>\n<ul>\n<li>\n<p>WORKPLACE</p>\n<ul>\n<li>\n<p>PHASE 1 9-12 / 6</p>\n<ul>\n<li>\n<p>as_form  3 | 1 </p>\n<ul>\n<li>\n<p>이게 왜 필요하지?</p>\n<ul>\n<li>pydantic validation error => RequestValidationError 로 변환하기</li>\n</ul>\n</li>\n<li>\n<p>class method, decorator 차이 비교</p>\n<ul>\n<li>\n<p>Openapi schema 안됨 </p>\n<ul>\n<li>Hey ! This is actually a great approach. I got only one question, is there a way to use this and include descriptions for each field to be displayed in swaggerUI/OpenAPI? I have tried</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>단순 class method 로도 안됨</li>\n</ul>\n</li>\n<li>\n<p>custom json response 비교 3 | 2</p>\n<ul>\n<li>fastapi response class 지정 </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>PHASE 2 13-16 / 6</p>\n<ul>\n<li>\n<p>aiohttp request class 달기 6 | </p>\n<ul>\n<li>요청 처리</li>\n<li>config yaml</li>\n<li>구동 command</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>PHASE 3 16-18 / 4</p>\n<ul>\n<li>로거 정리 4 | </li>\n<li>\n<p>구조 정리해보기?</p>\n<ul>\n<li>커밋 </li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-10-27-목\" style=\"position:relative;\"><a href=\"#22-10-27-%EB%AA%A9\" aria-label=\"22 10 27 목 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-27 목</h3>\n<ul>\n<li>\n<p>WORKPLACE</p>\n<ul>\n<li>\n<p>PHASE 1 9-12 / 6</p>\n<ul>\n<li>SessioCursor 찾아보기 => 그런거 없음</li>\n<li>구조 정리해보기?</li>\n<li>정책 정리?</li>\n</ul>\n</li>\n<li>\n<p>PHASE 2 13-16 / 6</p>\n<ul>\n<li>\n<p>fastapi 설명하기 4 | </p>\n<ul>\n<li>구조</li>\n<li>동작 흐름</li>\n<li>flaskt 대비 달라진점</li>\n<li>\n<p>이식 과정 전달</p>\n<ul>\n<li>\n<p>request</p>\n<ul>\n<li>query param / path param /  body</li>\n<li>service 붙이기</li>\n</ul>\n</li>\n<li>\n<p>response</p>\n<ul>\n<li>jsonable_encoder() </li>\n<li>typeError Handling</li>\n</ul>\n</li>\n<li>외부 요청 모듈</li>\n<li>서버 구동 동작</li>\n<li>config: 암호화…</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>path operator 인수 설명</p>\n<ul>\n<li><a href=\"https://fastapi.tiangolo.com/tutorial/path-operation-configuration/?h=path\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">공식문서 설명</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>PHASE 3 16-18 / 4</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-10-28-금\" style=\"position:relative;\"><a href=\"#22-10-28-%EA%B8%88\" aria-label=\"22 10 28 금 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-28 금</h3>\n<ul>\n<li>\n<p>WORKPLACE</p>\n<ul>\n<li>\n<p>PHASE 1 9-12 / 6</p>\n<ul>\n<li>\n<p>asyncpg: update or aiopg 사용 4 | 4</p>\n<ul>\n<li>\n<p>async pg query param 입력 지원 안함!!!</p>\n<ul>\n<li>wrapper에서 처리하기</li>\n</ul>\n</li>\n<li></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>PHASE 2 13-16 / 6</p>\n<ul>\n<li>설명 정리 4 |  4</li>\n<li>코드, 리포지토리 정리 2 | 2</li>\n<li>requirements.txt 정리 </li>\n</ul>\n</li>\n<li>\n<p>PHASE 3 16-18 / 4</p>\n<ul>\n<li>깃헙 레포 업로드</li>\n<li>locust bench 성능</li>\n<li>주간 보고</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"tel-trial-and-error-log\" style=\"position:relative;\"><a href=\"#tel-trial-and-error-log\" aria-label=\"tel trial and error log permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TEL (Trial and Error Log)</h2>\n<h3 id=\"22-10-24\" style=\"position:relative;\"><a href=\"#22-10-24\" aria-label=\"22 10 24 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-24</h3>\n<ul>\n<li>\n<p>ERROR: AttributeError: ‘AsyncConnection’ object has no attribute ‘cursor’</p>\n<ul>\n<li>\n<p>SITUATION:</p>\n<ul>\n<li>pd.read_sql( query, session.connect() )</li>\n</ul>\n</li>\n<li>\n<p>REASON:</p>\n<ul>\n<li>session에는 cursor가 없음</li>\n</ul>\n</li>\n<li>\n<p>SOLUTION:</p>\n<ul>\n<li>result = await session.execute(text(event<em>dict</em>query))</li>\n<li>pd.Dataframe([row for row in result])</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>ERROR: ValueError: [TypeError(“‘numpy.int64’ object is not iterable”), TypeError(‘vars() argument must have dict attribute’)]</p>\n<ul>\n<li>\n<p>SITUATION:</p>\n<ul>\n<li>fastapi returning model json encoding</li>\n</ul>\n</li>\n<li>\n<p>REASON:</p>\n<ul>\n<li>encode don’t know how to handle this kind of type</li>\n</ul>\n</li>\n<li>\n<p>SOLUTION:</p>\n<ul>\n<li>use CustomORJSONResponse</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-10-25\" style=\"position:relative;\"><a href=\"#22-10-25\" aria-label=\"22 10 25 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-25</h3>\n<ul>\n<li>\n<p>ERROR: </p>\n<ul>\n<li>RuntimeError: Timeout context manager should be used inside a task</li>\n<li>Unclosed client session</li>\n<li>client_session: &#x3C;aiohttp.client.ClientSession object at 0x100bd5a30></li>\n<li>\n<p>SITUATION:</p>\n<ul>\n<li>async client</li>\n</ul>\n</li>\n<li>\n<p>REASON:</p>\n<ul>\n<li>event loop 다름</li>\n</ul>\n</li>\n<li>\n<p>SOLUTION:</p>\n<ul>\n<li>async task, 돌고있는 event loop에 넣어야 함</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-10-27\" style=\"position:relative;\"><a href=\"#22-10-27\" aria-label=\"22 10 27 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-10-27</h3>\n<ul>\n<li>\n<p>ERROR: AttributeError: ‘coroutine’ object has no attribute ‘empty’</p>\n<ul>\n<li>\n<p>SITUATION:</p>\n<ul>\n<li>pd.read_sql engine으로 읽기</li>\n</ul>\n</li>\n<li>\n<p>REASON:</p>\n<ul>\n<li>data = async_func()</li>\n</ul>\n</li>\n<li>\n<p>SOLUTION:</p>\n<ul>\n<li>await 써주자</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>ERROR: sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) </p>\n<ul>\n<li>\n<p>SITUATION:</p>\n<ul>\n<li>async engine으로 pd.read_sql</li>\n</ul>\n</li>\n<li>\n<p>REASON:</p>\n<ul>\n<li>asyncpg SQL Param insert 미지원, 순수 SQL만 동작 가능</li>\n</ul>\n</li>\n<li>\n<p>SOLUTION:</p>\n<ul>\n<li>pd.read<em>sql</em>query 변경</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>ERROR: sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries</p>\n<ul>\n<li>\n<p>SITUATION:</p>\n<ul>\n<li>pd.read_sql with params</li>\n</ul>\n</li>\n<li>\n<p>REASON:</p>\n<ul>\n<li>list 형태로 Param 입력 안됨</li>\n</ul>\n</li>\n<li>\n<p>SOLUTION:</p>\n<ul>\n<li>insert with dictionary</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/posts/TIL&TEL_22-10-30/","tagSlugs":["/tag/til/","/tag/tel/"]},"frontmatter":{"date":"2022-10-30T01:23:45.678Z","description":" 22.10.24~22.10.30 배운것, 씨름한것들 ","tags":["TIL","TEL"],"title":" TIL&TEL 22.10.24~22.10.30  "}}},"pageContext":{"slug":"/posts/TIL&TEL_22-10-30/"}},"staticQueryHashes":["251939775","3613830147","401334301"]}